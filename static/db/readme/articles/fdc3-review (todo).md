FDC3 - микрофронты на десктопе

Краткий обзор FDC3 стандарта

FDC3 - это открытый стандарт передачи данных между финансовыми приложениями, используемый множеством финтех-компаний. Но по факту никто не ограничивает его применение только финансовыми приложениями - так что в более широком смысле это стандарт для общения между собой любых десктоп приложений.

Главная цель стандарта - описать и зафиксировать формат взаимодействия между десктоп приложениями. Ну и разумеется сделать это в реализации более дешёвым, чем разработка нормального api с бэкендом))

Главная страничка здесь: [fdc3.finos.org](https://fdc3.finos.org/);

Чтобы было понятно, какую проблему решает стандарт, давайте представим себе один день менеджера по закупкам автомобилей.

todo: надо описать кейс примерный

Большая пачка других кейсов лежит вот здесь: [use-cases](https://fdc3.finos.org/docs/use-cases/overview).

## Как будем щупать технологию

- зароемся в документацию
- посмотрим ютубчик
- погуглим обзорные статьи

Не так и много нашлось на самом деле (ну или время было ограничено). Нашлись следующие неплохие варианты представления инфы:

- хороший пример как настроить связку: https://www.youtube.com/watch?v=BJvbVeL7ZJA
- доки: https://github.com/finos/FDC3-Sail
- настройка: https://www.youtube.com/watch?v=5VJzftderO0
- курс https://learning.edx.org/course/course-v1:LinuxFoundationX+LFS177x+3T2021/home

Теперь опишем краткое ревью, чего там внутри по этим ссылкам нашлось:

- трёхуровневая структура
- Приложениями может быть что угодно (web, wpf, c++ и т.д)
- Весь контракт общения должен быть заранее описан в манифесте.
- Все приложения должны работать в контексте Desktop agent и на одном компе
- Создаваемый канал - односторонний. Отправитель делает raiseInten. Слушатель слушает и отвечает.Если делаем двусторонную передачу - то второе приложение должно открывать свой канал.

## Структура

Вся структура запускается на трёх уровнях

1. App Directory - место хранения конфига, манифеста, который определяет кто слушатель/кто публикует сообщения. Можно sail, можно хром расширение. В прод хз как
2. Desktop agent - является контекстом для запуска приложений. Предоставляет апи по fdc3
3. APPS - APP1 vs APP2 vs APP3 vs APP4

В декабре 2022 вышло опенсорс решение для Desctop Agent на веб стеке. Sail - это Desktop agent построенный на электроне.



Для коннекта между собой надо:

Описать в манифесте канал и данные, которыми должны обмениваться приложения. Установить контракт по сути.

- Запустить дестоп агент.
- Отправка сообщения (приложение 1)
  - Создать канал для общения channel = await getOrCreateChannel('myChannel')
  - Добавить слушателя контекста channel.addContextListener
  - Отправить данные через raiseIntent
- Обработка сообщения (приложение 2)
  - Создать канал для общения channel = await getOrCreateChannel('myChannel')
  - Добавить слушателя addIntentListener
  - Отправить ответ по контексту chanel.broadcast

Возможные флоу для демок:

На 2 приложения:

2 приложения. Одно для инициации продажи валюты. Второе - для непосредственного проведения транзакций. Нажали продать в одном, подтверждение и проведение в другом.
В принципе любое взаимодействие как в обычных фронтах сойдёт. По формуле 
1 Нажали кнопку А в приложении 1
2 Управление передалось в приложение 2
3 В приложении 2 нажали кнопку Б
4 Управление вернулось в приложение 1 и отправились туда данные из приложения 2
Что-то погенерить вот отсюда: https://fdc3.finos.org/docs/use-cases/overview



Рефы:

## Пример запуска Sail

Организовываем коммуникацию между пользователями одной социальной сеточки между землей и марсом.

- [sail](https://github.com/robzarel/fdc3-sail)
- [earth](https://github.com/robzarel/fdc3-earth)
- [mars](https://github.com/robzarel/fdc3-mars)

## Забавное

везде пишут про **It is also crucial to understand that FDC3 might not provide a complete solution for all your interop needs - nor does it aim to.** Следовательно могут быт приколы как со стандартом, так и с библиотеками (для веба и других платформ). Так как библиотеки сторонними ребятами разрабатываются, а сам стандарт **“platform and language indepemdent”**.
